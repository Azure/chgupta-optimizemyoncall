{
  "bv": 10,
  "component": "KustoLogs",
  "computedMetrics": null,
  "deleted": false,
  "description": null,
  "dimensions": null,
  "displayName": null,
  "enableClientEtwPublication": true,
  "enableClientSideForking": true,
  "enableClientSideLastSamplingMode": false,
  "enableClientSidePublication": true,
  "id": "contentLengthNearMaxSize",
  "isFromNewPipeline": false,
  "isQosMetric": false,
  "metrics": null,
  "monitors": [
    {
      "category": "",
      "conditions": [
        [
          "RPNamespace",
          "*",
          ""
        ]
      ],
      "customLinks": [
        {
          "$type": "Microsoft.Online.Metrics.Common.EventConfiguration.KustoJarvisLink, Microsoft.Online.Metrics.Common",
          "autoExecute": true,
          "compressQuery": true,
          "database": "ARMProd",
          "endpoint": "https://armprod.kusto.windows.net",
          "executionDelay": "00:00:00",
          "maxResultRowCount": 10,
          "preIncidentQueryTimeout": "00:00:50",
          "query": "HttpOutgoingRequests\n| where TIMESTAMP between (datetime({StartTime})..datetime({EndTime}))\n| where contentLength > 7864320\n| where hostName <> \"publishingstoredm.blob.core.windows.net\" and operationName !startswith \"GET/PRODCONTENT/\"\n| where hostName !in (\"qioimagesprod.blob.core.windows.net\", \"qioimagesdev.blob.core.windows.net\") and operationName <> \"GET/PACKAGE/\"\n| where hostName !startswith \"testmanagedappdeploy\" and operationName !startswith \"GET/TESTMANAGEDAPPDEPLOY\"\n| extend RPNamespaces = extract_all(@\"((?i)Microsoft(?-i)\\.[a-zA-Z]*)\", targetUri)\n| extend NamespaceCount = array_length(RPNamespaces) - 1\n| extend RPNamespace = toupper(RPNamespaces[NamespaceCount])\n| where RPNamespace == \"{Monitor.Dimension.RPNamespace}\"\n| project PreciseTimeStamp, correlationId, contentLength, operationName, targetUri",
          "title": "Responses Approaching Size Limit",
          "type": "Kusto"
        }
      ],
      "customMessage": "The resource provider sent a response greater than 7.5MB in size. Current ARM ServiceClientMaxResponseContentSize is 8MB. If responses exceed this limit, attempted reads will fail. Please investigate and take action to ensure that responses will not exceed this limit.",
      "customTitle": " {monitor.Dimension.RPNamespace} response payload approaching size limit",
      "dashboardName": "",
      "dashboardNamespace": "",
      "description": "This monitor tracks resource providers who send a response to ARM requests that exceeds 7.5MB in size. Current ServiceClientMaxResponseContentSize is 8MB and responses exceeding the limit will fail an attempted read. RPs approaching the limit should be notified in order to avoid exceeding the limit.",
      "desiredConditions": null,
      "eventIdentifier": {
        "component": "KustoLogs",
        "id": "contentLengthNearMaxSize",
        "tenant": "ARM"
      },
      "explicitPreAgg": null,
      "frequency": "00:05:00",
      "healthyCountToMitigateIncident": 10,
      "healthyDurationToMitigateIncident": "00:45:00",
      "hintsLookbackDuration": "1.00:00:00",
      "id": "RPResponseApproachingSizeLimit",
      "ingestionDelay": "00:00:00",
      "inputResourceType": "",
      "isDisabled": false,
      "isRegularMonitor": true,
      "isSilent": true,
      "isThrottled": false,
      "lastUpdatedBy": "dabooher",
      "lastUpdateTime": "2020-04-01T19:19:26.3159808Z",
      "lookbackDuration": "00:05:00",
      "metadata": [
        {
          "metadataKey": "Icm.CorrelationId",
          "metadataValue": "RPResponseApproachingSizeLimit:{monitor.Dimension.RPNamespace}"
        }
      ],
      "metricsViewName": "",
      "monitorActorConfiguration": {
        "additionalDataForMonitorsEnabled": false,
        "azureCacheTimeToExclude": "00:00:00",
        "baselineConcurrentGetAnomalyCallsV2": 0,
        "baselineFastServiceUri": null,
        "baselineFastServiceUriForAzure": null,
        "baselineIsAnomalyBatchProcessingSize": 0,
        "baselineServiceUri": null,
        "baselineServiceUriForAzure": null,
        "baselineServiceUseQueryService": false,
        "baselineUiFacingServiceUri": null,
        "baselineUiFacingServiceUriForAzure": null,
        "baseReportExpirationTimeInSeconds": 0,
        "batchReportingMonitor": false,
        "cacheTimeToExclude": "00:00:00",
        "cadMaxCombinationsEvaluationThreshold": 0,
        "certificateIdentifier": null,
        "certificateThumbprint": null,
        "combinationDeltaFetchLookback": "00:00:00",
        "combinationRefreshMinInterval": "00:00:00",
        "combinationsChunkSizePerConcurrentEvaluateBlock": 0,
        "consecutiveMonitorTimeoutsForAlerting": 0,
        "customizeSeverityForMonitorExecutionFailure": false,
        "debug": false,
        "disabled": false,
        "disableMetricDataInAlerts": false,
        "dqConcurrencyConfiguration": null,
        "dynamicThresholdMaxCombinationsEvaluationThreshold": 0,
        "enableCombinationsThrottlingForCad": false,
        "enableCostReporting": false,
        "enableDictionaryBasedMetricsSourceMatching": false,
        "enableGroupingByCommonDimensions": false,
        "enableHealthMonitors": false,
        "enableMonitorTimeoutAlerts": false,
        "enableQueryServiceQosMetricSupport": false,
        "enableSelectPreaggregate": false,
        "enableSubmitMetricsFromJs": false,
        "evaluatorTimeout": "00:00:00",
        "fetchDeltaHints": false,
        "hasUserConfigCacheTimeToExclude": null,
        "hintLookbackDuration": "00:00:00",
        "includeTimeSeriesInformationInWatchdogMetadata": false,
        "isThirdPartyStamp": false,
        "kenshoServiceUri": null,
        "logCombinationsInfo": false,
        "maxBufferSizeForRetrievedData": 0,
        "maxCombinationsCountPerPartition": 0,
        "maxCombinationsEvaluationThreshold": 0,
        "maxCombinationsForDataSources": 0,
        "maxCombinationsForMetricSources": 0,
        "maxConcurrentRetrieveOperations": 0,
        "maxDegreeOfParallelismForEvaluateBlock": 0,
        "maxFetchMetricsInJs": 0,
        "minCombinationsCountToRequirePartition": 0,
        "notQueryMetricsSourceCombinationIfNoWildcard": false,
        "overrideHealthDataValidation": false,
        "overrideMetricDataValidation": false,
        "partnerClientCertificateIdentifier": null,
        "preferMetricsStore": false,
        "preventCombinationsOverwriteByDeltaRefresh": false,
        "previewWithHistoricData": false,
        "removeExtraIngestionDelayInExecution": false,
        "removeExtraQueryComparison": false,
        "resourceTypeOverride": null,
        "treatInheritNotAsWildcard": false,
        "useAccountMigrationSupport": false,
        "useDefaultAzureMonitorLatency": false,
        "useHealthService": false,
        "useInternalHintingApi": false,
        "useLatestQueryRequestSerializationVersion": false,
        "useLowLatencyPipelineDataQualityForAzureMonitor": false,
        "useMetricsStoreMigrationSupport": false,
        "useNewHintingApi": false,
        "useNewMonitorTemplateInterface": false,
        "useNewMonitorTemplateInterfaceForDynamicThreshold": false,
        "useOptimizedMetricFetch": false,
        "useQueryServiceBatching": false,
        "useQueryServiceBatchingForJs": false,
        "useQueryServiceForCrossStampQuery": false,
        "useQueryServiceInMdmDataQualityClient": false,
        "useResolutionForAnomalyTimeWindowLookback": false,
        "zeroAsNoValueSentinel": false
      },
      "monitorDataSourceType": 0,
      "raiseIncientOnMonitorFailure": null,
      "resourceType": "RPsWithResponsesApproachingSizeLimit",
      "severityForMonitorFailure": 0,
      "shouldMitigateIncident": false,
      "shouldSendToAutomation": false,
      "templateSpecificParameters": {
        "metric": "Count"
      },
      "templateType": 2,
      "tenantName": "",
      "thresholds": [
        {
          "comparator": ">",
          "healthStatus": 2,
          "severity": 4,
          "value": 0.0
        }
      ],
      "version": 6
    }
  ],
  "pendingMetricsOrderingFix": false,
  "preferQueryMetricsStore": null,
  "replicationState": 0,
  "tenant": "ARM",
  "treatMissingSeriesAsZeros": false,
  "version": 0,
  "views": null
}